% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/forecast.R
\name{forecast}
\alias{forecast}
\title{Forecast R6 Class for Hidden Markov Models}
\value{
An R6 object with the following **notable public fields**:  
\describe{
  \item{hidden_state_forecast}{`nstates × T` matrix of forward state
        probabilities.}
  \item{obs_par_forecast}{Array of time-varying observation parameters.}
  \item{tpm_forecast}{Array of time-varying transition matrices.}
  \item{forecasted_pdfs}{List of unconditional pdf matrices, one per
        observation variable.}
  \item{x_vals}{List of grids on which each pdf was evaluated.}
}
}
\description{
Creates a *forecast* object from a fitted HMM model, projecting
future state probabilities and unconditional observation densities for a
user-defined horizon or covariate data-frame.
The forecasting is executed in the constructor; afterwards the results live
in public fields that can be queried or plotted directly.
}
\details{
**Algorithm overview**
\enumerate{
  \item Validate inputs (`private$validate_params()`).
  \item Build or accept a future design matrix (`forecast_data`).
  \item Obtain time-varying transition matrices (`tpm_forecast`) and
        observation parameters (`obs_par_forecast`) via `hmm$predict()`.
  \item Forward-propagate the hidden-state distribution
        (`hidden_state_forecast`).
  \item Marginalise over states to derive unconditional pdfs of each
        observation variable at a user-defined grid (`forecasted_pdfs`).
}
}
\examples{
\dontrun{
  mod <- HMM$new(file = "pois_mod.hmm")
  mod$fit()

  fc  <- forecast$new(hmm = mod, n = 12)

  # Plot the nth forecasted pdf for the first observation variable
  step <- 1
  ggplot() +
  geom_ridgeline(
    aes(
      x = fc$x_vals[[1]],
      y = 1,
      height = fc$forecasted_pdfs[[1]][, step]
    ),
    scale = 0.5
  ) +
  labs(
    title = sprintf("PDF for the \%d Time Step", step),
    x = sprintf("Observation Value: \%s", fc$observation_vars[[1]]),
    y = "Probability Density"
  )
}

}
\section{Methods}{
\subsection{Public methods}{
\itemize{
\item \href{#method-forecast-new}{\code{forecast$new()}}
\item \href{#method-forecast-clone}{\code{forecast$clone()}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-forecast-new"></a>}}
\if{latex}{\out{\hypertarget{method-forecast-new}{}}}
\subsection{Method \code{new()}}{
Construct a forecast object.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{forecast$new(
  hmm = NULL,
  n = NULL,
  forecast_data = NULL,
  preset_x_vals = NULL,
  starting_state_distribution = "last"
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{hmm}}{A fitted HMM object.}

\item{\code{n}}{Integer. Forecast horizon (ignored when `forecast_data` is supplied).}

\item{\code{forecast_data}}{`data.frame` of future covariates / IDs.
Must contain every covariate used in the fitted `hmm`.}

\item{\code{preset_x_vals}}{*Named* list whose elements are numeric vectors giving
the evaluation grid for each observation variable.  
Missing names fall back to a 90–110 % range of the training data.}

\item{\code{starting_state_distribution}}{Numeric vector of length `nstates()`, or
the string `"last"` (use the filtered distribution of the final
training row) or `"stationary"` (use the model’s stationary
distribution).}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-forecast-clone"></a>}}
\if{latex}{\out{\hypertarget{method-forecast-clone}{}}}
\subsection{Method \code{clone()}}{
The objects of this class are cloneable with this method.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{forecast$clone(deep = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{deep}}{Whether to make a deep clone.}
}
\if{html}{\out{</div>}}
}
}
}
